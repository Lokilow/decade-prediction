<!DOCTYPE html>
<html>
  <head>
    <title>valence</title>
    <script src="../static/js/jquery.min.js"></script>
    <link type="text/css" href="../static/css/bootstrap.min.css" rel="stylesheet">
    <link type="text/css" href="../static/css/my.css" rel="stylesheet">
    <script type='text/javascript' src="../static/js/bootstrap.min.js"></script>
    <script type='text/javascript' src="../static/js/bootstrap-slider.js"></script>
    <script src="../common/spotify_en_tools.js"></script>
    <link href="../static/css/bootstrap-slider.css" rel="stylesheet">
    <link type="text/css" href="../common/styles.css" rel="stylesheet" />
  </head>

<body>
<nav class="navbar navbar-default">
  <div class="container-fluid">
    <div class="navbar-header">
      <a class="navbar-brand" href="{{url_for('index')}}">valence space</a>
    </div>
    <div>
      <ul class="nav navbar-nav">
        <li><a href="{{url_for('visualizations')}}">visualizations</a></li>
        <li><a href="{{url_for('about')}}">about</a></li>
      </ul>
    </div>
  </div>
</nav>

 <div class='container font-light'>
   <div id='content' class="col-md-offset-5 col-md-8" position="fixed">
    <h2 id='title'>discover where your valence lies</h2>
</div>
 <div class='container font-light'>
   <div id='content' class="col-centered">
    <div class ='description'>
        The Echonest provides a song analysis features for many of the tracks available on Spotify.  Choose your parameters and
        hear what the music sounds like.  

    </div>
    <br>

<p>
<form class="navbar-form navbar-top col-centered" method="post" action="">
  <div class="form-group">
  {% for field in form %}
    <div class="row">
     <div class="input-group-sm container-fluid">
<!--       <label class="col-xs-1 control-label">
      <span class="input-group-addon"> \( {{ field.name }} \) </span>
      </label> -->
      <div position="absolute">
      {{ field(class_="my-form-control") }}
      </div>
      <div class="col-xs-3">
        {{ field.label }}
      </div>
      {% if field.errors %}
        {% for error in field.errors %}
          <div class="col-xs-3">
            <div style="color: red;">{{ error }}</div>
          </div>
        {% endfor %}
      {% endif %}
     </div>
    </div>
  {% endfor %}
<br/>
<input type="submit" value="Compute" class="btn btn-default">
</form>

<p>
{% if result != None %}
<p>This valence space sounds like the{{ result }}!</p>
{% endif %}
<br>
<!--     <form action = "/playlist">
    <div class='centered'>
        <div id='seed' class='centered'>
        <span> valence:
            <input title="Artist" type="number" size=34 id="feature" name="valence" value=0.5/>
        </span>
        
    </div>
</form>
<div id='seed' class='centered'>
        <span> danceability:
            <input title="Artist" type="number"  size=34 id="feature" name="danceability" value=0.5/>
        </span>
    </div>
        <div id='seed' class='centered'>
        <span> liveness:
            <input title="Artist" type="number"  size=34 id="feature" name="liveness" value=0.5/>
        </span>
    </div>
<div>
<button class="btn btn-sm" value="go" id="go" name="go"> Go </button>
</div> -->
       <!--  <div id='seed' class='centered'>
        <span> instrumentalness:
            <input title="Artist" type="text"  size=34 id="artist" name="artist" value='God is an Astronaut'/>
        </span>
        <button class="btn btn-sm" value="go" id="go" name="go"> Go </button>
    </div>
        <div id='seed' class='centered'>
        <span> speechiness:
            <input title="Artist" type="text"  size=34 id="artist" name="artist" value='God is an Astronaut'/>
        </span>
        <button class="btn btn-sm" value="go" id="go" name="go"> Go </button>
    </div>
        <div id='seed' class='centered'>
        <span> loudness:
            <input title="Artist" type="text"  size=34 id="artist" name="artist" value='God is an Astronaut'/>
        </span>
        <button class="btn btn-sm" value="go" id="go" name="go"> Go </button>
    </div>
        <div id='seed' class='centered'>
        <span> acousticness:
            <input title="Artist" type="text"  size=34 id="artist" name="artist" value='God is an Astronaut'/>
        </span>
        <button class="btn btn-sm" value="go" id="go" name="go"> Go </button>
    </div>
        <div id='seed' class='centered'>
        <span> tempo:
            <input title="Artist" type="text"  size=34 id="artist" name="artist" value='God is an Astronaut'/>
        </span>
        <button class="btn btn-sm" value="go" id="go" name="go"> Go </button>
    </div>
        <div id='seed' class='centered'>
        <span> key:
            <input title="Artist" type="text"  size=34 id="artist" name="artist" value='God is an Astronaut'/>
        </span>
        <button class="btn btn-sm" value="go" id="go" name="go"> Go </button>
    </div> -->
    <div id="info"> </div>
    <div id="all_results"> </div>
    <div id='footer'> 
        Powered by <a href="http://the.echonest.com">The Echo Nest</a> and <a href="http://spotify.com">Spotify</a>. 
    </div>
  </div>
<div id="contentframe" style="position:relative; top: 160px; left: 0px;">
<iframe src="https://embed.spotify.com/?uri=spotify:trackset:tracks:6RmGJuvOwCO0C51XDkQ4tc,1x6ACsKV4UdWS2FMuPFUiT,4bi73jCM02fMpkI11Lqmfe" frameborder="0" allowtransparency="true"></iframe>
  </div>
 </div>
</body>

<script type="text/javascript">
jQuery.ajaxSettings.traditional = true; 
var config = getConfig();

function fetchArtistPlaylist(artist,  wandering, variety) {
    var url = config.echoNestHost + 'api/v4/playlist/static';
    $("#all_results").empty();
    info("Creating the playlist ...");
    $.getJSON(url, { 'artist': artist, 
            'api_key': config.apiKey,
            'bucket': [ 'id:' + config.spotifySpace, 'tracks'], 'limit' : true,
            'variety' : 1, 'results': 40, 'type':'artist-radio',  }) 
        .done(function(data) {
            info("");
            if (! ('songs' in data.response)) {
                info("Can't find that artist");
            } else {
                var title = "Artist radio for " + artist;
                getSpotifyPlayer(data.response.songs, function(player) {
                    console.log('got the player');
                    $("#all_results").append(player);
                });
            }
        })
        .error( function() {
            info("Whoops, had some trouble getting that playlist");
        }) ;
}
function newArtist() {
    var artist = $("#artist").val();
    fetchArtistPlaylist(artist, false, .2);
}
function info(txt) {
    $("#info").text(txt);
}
function initUI() {
    $("#artist").on('keydown', function(evt) {
        if (evt.keyCode == 13) {
            newArtist();
        }
    });
    $("#go").on("click", function() {
        newArtist();
    });
}
$(document).ready(function() {
    initUI();
});
</script>
</html>